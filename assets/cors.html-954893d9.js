import{_ as c,M as s,p as l,q as d,Q as p,R as e,N as o,V as r,t as a,a1 as i}from"./framework-d3922052.js";const u={},h=e("h1",{id:"跨域资源共享",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#跨域资源共享","aria-hidden":"true"},"#"),a(" 跨域资源共享")],-1),g=e("h2",{id:"_1-什么是-cors",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#_1-什么是-cors","aria-hidden":"true"},"#"),a(" 1. 什么是 CORS")],-1),k=e("strong",null,"跨源资源共享",-1),_=e("sup",{class:"footnote-ref"},[e("a",{href:"#footnote1"},"[1]"),e("a",{class:"footnote-anchor",id:"footnote-ref1"})],-1),m=i(`<p>出于安全性，浏览器限制脚本内发起的跨源 HTTP 请求。例如，<code>XMLHttpRequest</code> 和 Fetch API 遵循同源策略。</p><h2 id="_2-http-头部" tabindex="-1"><a class="header-anchor" href="#_2-http-头部" aria-hidden="true">#</a> 2. HTTP 头部</h2><h3 id="_2-1-access-control-allow-origin" tabindex="-1"><a class="header-anchor" href="#_2-1-access-control-allow-origin" aria-hidden="true">#</a> 2.1 <code>Access-Control-Allow-Origin</code></h3><div class="language-yaml" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">Access-Control-Allow-Origin</span><span class="token punctuation">:</span> &lt;origin<span class="token punctuation">&gt;</span> <span class="token punctuation">|</span> *
</code></pre></div><p>其中，<code>origin</code> 参数的值指定了允许访问该资源的外域 URI。对于不需要携带身份凭证的请求，服务器可以指定该字段的值为通配符，表示允许来自所有域的请求。</p><p>例如，下面的字段值将允许来自 <code>https://mozilla.org</code> 的请求：</p><div class="language-yaml" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">Access-Control-Allow-Origin</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//mozilla.org
<span class="token key atrule">Vary</span><span class="token punctuation">:</span> Origin
</code></pre></div><p>如果服务端指定了具体的域名而非 <code>*</code>，那么响应首部中的 <code>Vary</code> 字段的值必须包含 <code>Origin</code>。这将告诉客户端：服务器对不同的源站返回不同的内容。</p><h3 id="_2-2-access-control-expose-headers" tabindex="-1"><a class="header-anchor" href="#_2-2-access-control-expose-headers" aria-hidden="true">#</a> 2.2 <code>Access-Control-Expose-Headers</code></h3><p>在跨源访问时，<code>XMLHttpRequest</code> 对象的 <code>getResponseHeader()</code> 方法只能拿到一些最基本的响应头，<code>Cache-Control</code>、<code>Content-Language</code>、<code>Content-Type</code>、<code>Expires</code>、<code>Last-Modified</code>、<code>Pragma</code>，如果要访问其他头，则需要服务器设置本响应头。</p><p><code>Access-Control-Expose-Headers</code> 头让服务器把允许浏览器访问的头放入白名单，例如：</p><div class="language-yaml" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">Access-Control-Expose-Headers</span><span class="token punctuation">:</span> X<span class="token punctuation">-</span>My<span class="token punctuation">-</span>Custom<span class="token punctuation">-</span>Header<span class="token punctuation">,</span> X<span class="token punctuation">-</span>Another<span class="token punctuation">-</span>Custom<span class="token punctuation">-</span>Header
</code></pre></div><p>这样浏览器就能够通过 <code>getResponseHeader()</code> 访问 <code>X-My-Custom-Header</code> 和 <code>X-Another-Custom-Header</code> 响应头了。</p><h3 id="_2-3-access-control-max-age" tabindex="-1"><a class="header-anchor" href="#_2-3-access-control-max-age" aria-hidden="true">#</a> 2.3 <code>Access-Control-Max-Age</code></h3><p><code>Access-Control-Max-Age</code> 头指定了 Preflight（预检）请求的结果能够被缓存多久。</p><div class="language-yaml" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">Access-Control-Max-Age</span><span class="token punctuation">:</span> &lt;delta<span class="token punctuation">-</span>seconds<span class="token punctuation">&gt;</span>
</code></pre></div><p><code>delta-seconds</code> 参数表示 Preflight 请求的结果在多少秒内有效。</p><h3 id="_2-4-access-control-allow-credentials" tabindex="-1"><a class="header-anchor" href="#_2-4-access-control-allow-credentials" aria-hidden="true">#</a> 2.4 <code>Access-Control-Allow-Credentials</code></h3><p><code>Access-Control-Allow-Credentials</code> 头指定了当浏览器的 <code>credentials</code> 设置为 <code>true</code> 时是否允许浏览器读取 <code>response</code> 的内容。当用在对 Preflight 请求的响应中时，它指定了实际的请求是否可以使用 <code>credentials</code>。</p><blockquote><p>请注意：简单 <code>GET</code> 请求不会被预检；如果对此类请求的响应中不包含该字段，这个响应将被忽略掉，并且浏览器也不会将相应内容返回给网页。</p></blockquote><div class="language-yaml" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">Access-Control-Allow-Credentials</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</code></pre></div><h3 id="_2-5-access-control-allow-methods" tabindex="-1"><a class="header-anchor" href="#_2-5-access-control-allow-methods" aria-hidden="true">#</a> 2.5 <code>Access-Control-Allow-Methods</code></h3><p><code>Access-Control-Allow-Methods</code> 首部字段用于预检请求的响应。其指明了实际请求所允许使用的 HTTP 方法。</p><div class="language-yaml" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">Access-Control-Allow-Methods</span><span class="token punctuation">:</span> &lt;method<span class="token punctuation">&gt;</span><span class="token punctuation">[</span><span class="token punctuation">,</span> &lt;method<span class="token punctuation">&gt;</span><span class="token punctuation">]</span>*
</code></pre></div><p>有关 Preflight 请求的示例已在上方给出。</p><h3 id="_2-6-access-control-allow-headers" tabindex="-1"><a class="header-anchor" href="#_2-6-access-control-allow-headers" aria-hidden="true">#</a> 2.6 <code>Access-Control-Allow-Headers</code></h3><p><code>Access-Control-Allow-Headers</code> 首部字段用于预检请求的响应。其指明了实际请求中允许携带的首部字段。</p><div class="language-yaml" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">Access-Control-Allow-Headers</span><span class="token punctuation">:</span> &lt;field<span class="token punctuation">-</span>name<span class="token punctuation">&gt;</span><span class="token punctuation">[</span><span class="token punctuation">,</span> &lt;field<span class="token punctuation">-</span>name<span class="token punctuation">&gt;</span><span class="token punctuation">]</span>*
</code></pre></div><hr class="footnotes-sep">`,29),f={class:"footnotes"},C={class:"footnotes-list"},A={id:"footnote1",class:"footnote-item"},y={href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS",target:"_blank",rel:"noopener noreferrer"},x=e("a",{href:"#footnote-ref1",class:"footnote-backref"},"↩︎",-1);function w(v,H){const n=s("Badge"),t=s("ExternalLinkIcon");return l(),d("div",null,[h,p(" [[TOC]] "),g,e("p",null,[o(n,{type:"tip",vertical:"middle"},{default:r(()=>[a("定义")]),_:1}),a(),k,a("（CORS）是一种基于 HTTP 头的机制，该机制通过允许服务器标示除了它自己以外的其它源。"),_]),m,e("section",f,[e("ol",C,[e("li",A,[e("p",null,[a("跨源资源共享（CORS），MDN，"),e("a",y,[a("https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS"),o(t)]),a(),x])])])])])}const T=c(u,[["render",w],["__file","cors.html.vue"]]);export{T as default};
